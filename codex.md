# Response Language

Always respond in Korean. 모든 응답은 한국어로 해야 합니다. pr 내용, 코멘트, 이슈, 커밋 메시지 등등 사용자가 읽을 수 있는 모든 출력은 한국어여야만 합니다.

# 개발 환경 및 워크플로우

## 프로젝트 구조
- 이 프로젝트는 pnpm + Turbo 기반의 모노레포(monorepo) 구조로 구성되어 있다.
- 여러 패키지가 하나의 저장소에서 관리되며, 의존성과 빌드 과정이 효율적으로 공유된다.

## 작업 완료 기준
- 모든 작업(기능 개발, 버그 수정, 리팩터링 등)을 완료한 후에는 반드시 프로젝트 루트에서 다음 명령어들을 순차적으로 실행하고 모두 통과해야 한다:
  1. `pnpm prisma:generate` - Prisma 클라이언트 코드 생성
  2. `pnpm gql:all` - GraphQL 스키마 및 타입 정의 생성
  3. `pnpm lint:fix` - 코드 스타일 및 품질 검증
  4. `pnpm build` - 전체 프로젝트 빌드
  5. `pnpm test:cov` - 테스트 실행 및 커버리지 확인
- 위 명령어 중 하나라도 실패하면 해당 문제를 해결한 후 다시 전체 과정을 수행한다.
- 데이터베이스 스키마 변경이 필요한 경우, 반드시 프로젝트 루트에서 `pnpm prisma:migrate`를 실행해 마이그레이션을 적용하고 관련 결과물을 커밋한다.
- gql 스키마, 린트 수정 등의 결과도 포함하여 커밋되어야 한다.
- 일부 파일만 수정된 경우에도 전체의 정합성 확인을 위해서, 필터 등의 조건 없이 모두에 대해서 명령어를 실행한다.
- 이 검증 과정은 Pull Request 생성 전 필수 체크리스트로 활용한다.

# TDD 운영 원칙

## 프로젝트 기본 방향
- 이 프로젝트는 테스트 주도 개발(Test-Driven Development, TDD)을 기본 개발 방식으로 채택한다.
- 모든 기능은 테스트를 먼저 작성한 뒤, 구현과 리팩터링을 순차적으로 진행한다.
- 기능 구현과 테스트 작성은 작은 단위로 반복하여 팀 전체가 빠르게 피드백을 얻는다.

## TDD 핵심 규칙
1. 실패하는 테스트를 먼저 작성한다. (Red 단계)
2. 테스트를 통과시키기 위한 최소한의 코드만 작성한다. (Green 단계)
3. 테스트를 유지한 채로 코드를 정리하고 개선한다. (Refactor 단계)
4. 테스트가 실패한 상태에서 프로덕션 코드를 작성하거나 수정하지 않는다.
5. 명확한 요구사항 없이 테스트나 프로덕션 코드를 추가하지 않는다.

## 테스트 작성 기준과 원칙
- 테스트는 단일 책임을 갖도록 설계하고, 기대 결과를 명확히 표현한다.
- Arrange-Act-Assert 패턴을 사용하여 가독성을 높인다.
- 테스트 이름은 시스템의 행동을 설명하는 자연어 문장 형태로 작성한다.
- 공용 픽스처나 모듈은 중복을 줄이되, 테스트 간 의존성을 만들지 않는다.
- 외부 의존성은 테스트 더블(mock, stub 등)을 활용하여 제어 가능하게 유지한다.

## 리팩터링과 설계 방향성
- 리팩터링 시 테스트 커버리지를 유지하며, 구조 개선은 작은 단계로 진행한다.
- 중복 제거, 의도 명확화, 응집도 향상을 우선순위로 삼는다.
- 설계 개선은 테스트가 문서 역할을 하도록 지원하며, 테스트가 깨지면 원인을 즉시 파악한다.

## 품질 측정과 검증 기준
- 새로운 기능은 반드시 관련 테스트가 포함된 상태로 머지한다.
- 회귀 방지를 위해 버그 수정 시 재현 테스트를 작성하고, 실패를 확인한 뒤 수정한다.
- 지속적 통합(CI) 환경에서 모든 테스트가 통과된 경우에만 배포를 진행한다.
- 테스트 커버리지는 기능 범위에 비례하도록 지속적으로 모니터링한다.
- 프론트엔드와 백엔드 모두 전역 기준으로 Statement/Line/Function 커버리지는 최소 85%, Branch 커버리지는 최소 75%를 유지한다.
- 커버리지 임계값을 한 번 충족하면 이후 PR에서도 동일 수준 혹은 그 이상의 커버리지를 유지하며, 하향 조정이 필요할 경우 팀 합의를 거쳐 문서를 갱신한다.

## 협업 가이드
- 코드 리뷰에서는 테스트의 적절성, 경계 조건, 실패 케이스 포함 여부를 우선 확인한다.
- 테스트 실패 시, 원인이 파악될 때까지 프로덕션 코드 변경을 보류한다.
- 테스트 전략이나 기준에 대한 변경이 필요하면 문서를 업데이트하고 팀과 합의한다.
